
# Content based filtering
alert tcp any any -> $HTTP_SERVERS $HTTP_PORTS (\
                msg:"NetSec Exam Page Access Requested"; \
                sid:100002; rev:1; \
                pcre:!"/index.html/i"; \
                flowbits:set, epage_access; \
		flowbits: noalert; )
alert tcp any any <> $HTTP_SERVERS $HTTP_PORTS (\
		msg:"NetSec Exam Page Access"; \
		sid:100003; rev:1; \
		file_data; pcre:"/Network Security Exam \d{4}/i"; \
		flowbits:isset, epage_access; \
		classtype:NetSec Exam Page Access; )


# File type based filtering
alert tcp any any -> $HTTP_SERVERS $HTTP_PORTS (\
		msg:"NetSec Exam Download Requested"; \
		sid:100004; rev:1; \
		pcre:"/netsec\/exam\d{4}.pdf/i"; \
		flowbits:set, exam_download; \
		flowbits:noalert; )
alert tcp any any <> $HTTP_SERVERS $HTTP_PORTS (\
                msg:"NetSec Exam Download"; \
                sid:100005; rev:1; \
		file_data; pcre:"/pdf/i"; \
		flowbits:isset, exam_download; \
		classtype:NetSec Exam Download; )


# URI filtering
alert tcp any any -> $HTTP_SERVERS $HTTP_PORTS (\
                msg:"NetSec Solution Access Requested"; \
                sid:100006; rev:1; \
                pcre:"/netsec\/exam\d{4}_solution-v\d{3}.jpg/i"; \
		flowbits:set, solution_access; \
                flowbits:noalert;)
alert tcp any any <> $HTTP_SERVERS $HTTP_PORTS (\
                msg:"NetSec Solution Access"; \
                sid:100007; rev:1; \
                content:"200"; http_stat_code; \
                flowbits:isset, solution_access; \
		classtype:NetSec Solution Access; )

